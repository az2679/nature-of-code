import"./modulepreload-polyfill-3cfb730f.js";class g{constructor(s,i,t){this.x=s,this.y=i,this.userData=t}sqDistanceFrom(s){const i=s.x-this.x,t=s.y-this.y;return i*i+t*t}distanceFrom(s){return Math.sqrt(this.sqDistanceFrom(s))}}class c{constructor(s,i,t,h){this.x=s,this.y=i,this.w=t,this.h=h,this.left=s-t/2,this.right=s+t/2,this.top=i-h/2,this.bottom=i+h/2}contains(s){return this.left<=s.x&&s.x<=this.right&&this.top<=s.y&&s.y<=this.bottom}intersects(s){return!(this.right<s.left||s.right<this.left||this.bottom<s.top||s.bottom<this.top)}subdivide(s){switch(s){case"ne":return new c(this.x+this.w/4,this.y-this.h/4,this.w/2,this.h/2);case"nw":return new c(this.x-this.w/4,this.y-this.h/4,this.w/2,this.h/2);case"se":return new c(this.x+this.w/4,this.y+this.h/4,this.w/2,this.h/2);case"sw":return new c(this.x-this.w/4,this.y+this.h/4,this.w/2,this.h/2)}}xDistanceFrom(s){return this.left<=s.x&&s.x<=this.right?0:Math.min(Math.abs(s.x-this.left),Math.abs(s.x-this.right))}yDistanceFrom(s){return this.top<=s.y&&s.y<=this.bottom?0:Math.min(Math.abs(s.y-this.top),Math.abs(s.y-this.bottom))}sqDistanceFrom(s){const i=this.xDistanceFrom(s),t=this.yDistanceFrom(s);return i*i+t*t}distanceFrom(s){return Math.sqrt(this.sqDistanceFrom(s))}}class l{constructor(s,i,t,h,r){this.pos=createVector(s,i),this.vel=createVector(t,h),this.acc=createVector(0,0),this.mass=r,this.r=sqrt(this.mass)*2}intersect(s){return dist(this.pos.x,this.pos.y,s.pos.x,s.pos.y)<this.r+s.r}repulse(s){let i=p5.Vector.sub(this.pos,s.pos),t=constrain(i.magSq(),100,1e3),r=1*(this.mass*s.mass)/t;i.setMag(r),i.mult(-1),s.applyForce(i)}attract(s){let i=p5.Vector.sub(this.pos,s.pos),t=constrain(i.magSq(),100,1e3),h=G*(this.mass*s.mass)/t;i.setMag(h),s.applyForce(i)}drag(s){let i=this.vel.copy();i.normalize(),i.mult(-1);let t=this.vel.magSq();i.setMag(s*t),this.applyForce(i)}friction(){if(height-(this.pos.y+this.r)<1){let i=this.vel.copy();i.normalize(),i.mult(-1);let t=this.mass;i.setMag(mu*t),this.applyForce(i)}}applyForce(s){let i=p5.Vector.div(s,this.mass);this.acc.add(i)}edges(){this.pos.y>=height-this.r&&(this.pos.y=height-this.r,this.vel.y*=-1),this.pos.x>=width-this.r?(this.pos.x=width-this.r,this.vel.x*=-1):this.pos.x<=this.r&&(this.pos.x=this.r,this.vel.x*=-1)}update(){this.vel.add(this.acc),this.pos.add(this.vel),this.acc.set(0,0)}show(){ellipse(this.pos.x,this.pos.y,this.r*2)}}let o=[],d,a,u,y,n=[],m,f;new p5(e=>{e.setup=()=>{e.createCanvas(windowWidth,windowHeight),e.background(246,238,227),e.noStroke(),m=e.color(248,148,143),f=e.color(203,190,250);for(let i=0;i<50;i++){let t=p5.Vector.random2D(),h=t.copy();h.setMag(random(5,10)),t.setMag(random(150,200)),h.rotate(PI/2);let r=random(10,15);o[i]=new l(t.x,t.y,h.x,h.y,r)}a=new l(0,0,0,0,500),u=new l(-150,-150,0,0,5e3),y=new l(150,150,0,0,5e3)},e.draw=()=>{e.clear(),e.background(160);let i=new c(0,0,width,height);d=Quadtree.create(i,8);for(let t of o){let h=new g(t.pos.x,t.pos.y,t);d.insert(h)}e.strokeWeight(20),e.stroke(255);for(let t=0;t<n.length;t++)e.point(n[t].pos.x,n[t].pos.y);e.strokeWeight(1);for(let t of o){s(t,d),a.attract(t);for(let h=0;h<n.length;h++)n[h].attract(t)}e.noStroke(),e.push(),e.translate(width/2,height/2),e.fill(0),e.ellipse(a.pos.x,a.pos.y,20);for(let t=0;t<o.length;t++){e.lerpColor(m,f,t/o.length);let h=e.dist(o[t].pos.x,o[t].pos.y,a.pos.x,a.pos.y),r=e.map(h,0,width*.15,0,255),w=e.map(h,0,width*.2,0,1),p=e.lerpColor(m,f,w);e.fill(p);let x=e.createVector(0,.2);p5.Vector.mult(x,o[t].mass),o[t].intersect(u)?e.fill(r):o[t].intersect(y)?e.fill(e.map(h,0,width*.4,255,0)):e.fill(p),o[t].update(),o[t].show()}e.stroke(255),e.noFill(),u.show(),y.show(),e.pop()},e.mousePressed=()=>{let i=new l(e.mouseX,e.mouseY,0,0,100);n.push(i),i.intersect(a)};function s(i,t){if(e.dist(i.pos.x,i.pos.y,t.boundary.x,t.boundary.y)<25){if(t.points)for(let r of t.points)i!=r.userData&&r.userData.attract(i)}else t.points&&new l(t.boundary.x,t.boundary.y,0,0,i.mass*t.points.length).attract(i);t.divided&&(s(i,t.northeast),s(i,t.northwest),s(i,t.southeast),s(i,t.southwest))}});
